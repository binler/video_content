<fieldset id="work_fields">
  <legend>Description</legend>
  <% event_obj = @document_fedora.parent_event %>
  <% num_of_creators = event_obj.datastreams["descMetadata"].get_values([:pbcoreDescriptionDocument, :pbcoreCreator]).size %>
  <% i = 0 %>
  <% owner_index = 0 %>
  <% creator_index = 0 %>
  <% while i < num_of_creators do %>
    <%- if((get_values_from_datastream(event_obj, "descMetadata", [:pbcoreDescriptionDocument, {:pbcoreCreator => i}, :creatorRole, :creatorRole_annotation])).to_s.eql?(@document_fedora.pid.to_s)) -%>
      <%- if((get_values_from_datastream(event_obj, "descMetadata", [:pbcoreDescriptionDocument, {:pbcoreCreator => i}, :creator, :creator_annotation])).to_s.eql?"creator") -%>
        <% creator_index = i %>
      <%- elsif((get_values_from_datastream(event_obj, "descMetadata", [:pbcoreDescriptionDocument, {:pbcoreCreator => i}, :creator, :creator_annotation])).to_s.eql?"owner") -%>
	<% owner_index = i %>
      <%- end -%>
    <%- end -%>
    <% i = i+1 %>
  <%- end -%>
    <dl>
    <% unless get_values_from_datastream(event_obj, "descMetadata", [:pbcoreDescriptionDocument, {:pbcoreCreator => owner_index}, :creator]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:pbcoreDescriptionDocument, {:pbcoreCreator => owner_index}, :creator], "Owner:") %>
      </dt>
      <dd class="owner">
	<%= get_values_from_datastream(event_obj, "descMetadata", [:pbcoreDescriptionDocument, {:pbcoreCreator => owner_index}, :creator]) %>
      </dd>
    <% end %>
    <% unless get_values_from_datastream(event_obj, "descMetadata", [:pbcoreDescriptionDocument, {:pbcoreCreator => creator_index}, :creator]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:pbcoreDescriptionDocument, {:pbcoreCreator => creator_index}, :creator], "Creator:") %>
      </dt>
      <dd class="creator">
        <%= get_values_from_datastream(event_obj, "descMetadata", [:pbcoreDescriptionDocument, {:pbcoreCreator => creator_index}, :creator]) %>
      </dd>
    <% end %>
    <% unless get_values_from_datastream(@document_fedora,"properties", [:derivative_type]).first.empty? %>
      <dt>
        <%= fedora_field_label("properties", [:derivative_type], "Derivative Type:") %>
      </dt>
      <dd class="derivative_type">
        <%= get_values_from_datastream(@document_fedora,"properties", [:derivative_type]) %>
      </dd>
    <% end %>

    <% unless get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :instantiationIdentifier]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:instantiationPart, :instantiationIdentifier], "ID:") %>
      </dt>
      <dd class="title">
        <%= get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :instantiationIdentifier]) %>
      </dd>
    <% end %>

    <% unless get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :instantiationDate]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:instantiationPart, :instantiationDate], "Creation Date:") %>
      </dt>
      <dd class="event_id">
        <%= get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :instantiationDate]) %>
      </dd>
    <% end %>

    <% unless get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :essenceTrack, :essenceTrackDuration]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:instantiationPart, :essenceTrack, :essenceTrackDuration], "Track Duration:") %>
      </dt>
      <dd class="date">
        <%= get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :essenceTrack, :essenceTrackDuration]) %>
      </dd>
    <% end %>

    <% unless get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :essenceTrack, :essenceTrackDataRate]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:instantiationPart, :essenceTrack, :essenceTrackDataRate], "Track Data Rate:") %>
      </dt>
      <dd class="description">
        <%= get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :essenceTrack, :essenceTrackDataRate]) %>
      </dd>
    <% end %>

    <% unless get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :essenceTrack, :essenceTrackAspectRatio]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:instantiationPart, :essenceTrack, :essenceTrackAspectRatio], "Aspect Ratio:") %>
      </dt>
      <dd class="keyword">
        <%= get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :essenceTrack, :essenceTrackAspectRatio]) %>
      </dd>
    <% end %>

    <% unless get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :fileSize]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:instantiationPart, :fileSize], "File Size:") %>
      </dt>
      <dd class="keyword">
        <%= get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :fileSize]) %>
        <%= get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :fileSize, :fileSize_unit]) %>
      </dd>
    <% end %>

    <% unless get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :digital]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:instantiationPart, :digital], "File Format:") %>
      </dt>
      <dd class="keyword">
        <%= get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, :digital]) %>
      </dd>
    <% end %>

    <% unless get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, {:instantiationAnnotation => "0"}, :text]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:instantiationPart, {:instantiationAnnotation => "0"}, :text], "Description:") %>
      </dt>
      <dd class="description">
        <%= get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, {:instantiationAnnotation => "0"}, :text]) %>
      </dd>
    <% end %>

    <% unless get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, {:instantiationAnnotation => "1"}, :text]).first.empty? %>
      <dt>
        <%= fedora_field_label("descMetadata", [:instantiationPart, {:instantiationAnnotation => "1"}, :text], "Retention Schedule:") %>
      </dt>
      <dd class="retention_schedule">
        <%= get_values_from_datastream(@document_fedora,"descMetadata", [:instantiationPart, {:instantiationAnnotation => "1"}, :text]) %>
      </dd>
    <% end %>

    <% unless get_values_from_datastream(@document_fedora,"properties", [:chapter]).first.empty? %>
      <dt>
        <%= fedora_field_label("properties", [:chapter], "Chapter:") %>
      </dt>
      <dd class="chapter">
        <%= get_values_from_datastream(@document_fedora,"properties", [:chapter]) %>
      </dd>
    <% end %>

    </dl>
  </fieldset>
